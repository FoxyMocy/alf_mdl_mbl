(window.webpackJsonp=window.webpackJsonp||[]).push([[67],{t6Y4:function(e,o,t){"use strict";t.r(o),t.d(o,"CoreCoursesMyLazyModule",(function(){return T}));var s=t("tyNb"),a=t("L3Fv"),r=t("5p9q"),i=t("dQ3M"),n=t("mrSG"),c=t("fDR4"),l=t("FYaz"),d=t("mSZx"),u=t("6akD"),b=t("OYIH"),g=t("YyYz"),y=t("9+EE"),C=t("3LXp"),h=t("bFG1"),v=t("fjkH"),_=t("Xzvb"),m=t("fXoL"),f=t("TEn/"),p=t("C1x5"),k=t("nt/U"),M=t("PgjG"),P=t("ofXK"),w=t("ACYt"),D=t("3CSS"),O=t("aSim"),B=t("r8G5"),E=t("sYmb");function CoreCoursesMyPage_div_20_ion_button_1_Template(e,o){if(1&e){const e=m.Fc();m.Ec(0,"ion-button",18),m.Mc("click",(function CoreCoursesMyPage_div_20_ion_button_1_Template_ion_button_click_0_listener(){m.fd(e);return m.Oc(2).myOverviewBlock.prefetchCourses()})),m.Pc(1,"translate"),m.zc(2,"ion-icon",19),m.Dc()}if(2&e){const e=m.Oc(2);m.mc("aria-label",m.Qc(1,2,e.myOverviewBlock.prefetchCoursesData.statusTranslatable)),m.lc(2),m.Vc("name",e.myOverviewBlock.prefetchCoursesData.icon)}}function CoreCoursesMyPage_div_20_ion_badge_2_Template(e,o){if(1&e&&(m.Ec(0,"ion-badge",20),m.pd(1),m.Dc()),2&e){const e=m.Oc(2);m.mc("aria-valuemax",e.myOverviewBlock.prefetchCoursesData.total)("aria-valuenow",e.myOverviewBlock.prefetchCoursesData.count)("aria-valuetext",e.myOverviewBlock.prefetchCoursesData.badgeA11yText),m.lc(1),m.rd(" ",e.myOverviewBlock.prefetchCoursesData.badge," ")}}function CoreCoursesMyPage_div_20_ion_spinner_3_Template(e,o){1&e&&(m.zc(0,"ion-spinner"),m.Pc(1,"translate")),2&e&&m.mc("aria-label",m.Qc(1,1,"core.loading"))}function CoreCoursesMyPage_div_20_Template(e,o){if(1&e&&(m.Ec(0,"div",14),m.nd(1,CoreCoursesMyPage_div_20_ion_button_1_Template,3,4,"ion-button",15),m.nd(2,CoreCoursesMyPage_div_20_ion_badge_2_Template,2,4,"ion-badge",16),m.nd(3,CoreCoursesMyPage_div_20_ion_spinner_3_Template,2,3,"ion-spinner",17),m.Dc()),2&e){const e=m.Oc();m.lc(1),m.Vc("ngIf",!e.myOverviewBlock.prefetchCoursesData.loading),m.lc(1),m.Vc("ngIf",e.myOverviewBlock.prefetchCoursesData.badge),m.lc(1),m.Vc("ngIf",e.myOverviewBlock.prefetchCoursesData.loading)}}function CoreCoursesMyPage_core_block_22_Template(e,o){if(1&e&&m.zc(0,"core-block",21),2&e){const e=m.Oc();m.Vc("block",e.loadedBlock)("instanceId",e.userId)}}function CoreCoursesMyPage_core_block_side_blocks_button_23_Template(e,o){if(1&e&&m.zc(0,"core-block-side-blocks-button",22),2&e){const e=m.Oc();m.Vc("instanceId",e.userId)("myDashboardPage",e.myPageCourses)}}function CoreCoursesMyPage_core_empty_box_24_Template(e,o){1&e&&(m.zc(0,"core-empty-box",23),m.Pc(1,"translate")),2&e&&m.Vc("message",m.Qc(1,1,"core.course.nocontentavailable"))}let I=(()=>{class CoreCoursesMyPage{constructor(e){this.loadsManager=e,this.siteName="",this.downloadCoursesEnabled=!1,this.loaded=!1,this.myPageCourses=b.b.MY_PAGE_COURSES,this.hasSideBlocks=!1,this.onReadyPromise=new l.a,this.updateSiteObserver=v.b.on(v.b.SITE_UPDATED,(()=>Object(n.a)(this,void 0,void 0,(function*(){this.downloadCoursesEnabled=!_.a.isDownloadCoursesDisabledInSite(),yield this.loadSiteName()}))),y.b.getCurrentSiteId()),this.userId=y.b.getCurrentSiteUserId(),this.loadsManagerSubscription=this.loadsManager.onRefreshPage.subscribe((()=>{this.loaded=!1,this.loadContent()}))}ngOnInit(){return Object(n.a)(this,void 0,void 0,(function*(){this.downloadCoursesEnabled=!_.a.isDownloadCoursesDisabledInSite();(new g.a).treatLink(),yield this.loadSiteName(),this.loadContent(!0)}))}loadContent(e=!1){var o,t,s;return Object(n.a)(this,void 0,void 0,(function*(){const a=this.loadsManager.startPageLoad(this,!!e),r=yield b.a.isAvailable(),i=yield _.a.isMyCoursesDisabled(),n=!!(null===(o=y.b.getCurrentSite())||void 0===o?void 0:o.isVersionGreaterEqualThan("4.0"));if(r&&!i)try{const e=yield a.watchRequest(b.a.getDashboardBlocksObservable({myPage:n?this.myPageCourses:void 0,readingStrategy:a.getReadingStrategy()}));this.loadedBlock=e.mainBlocks.concat(e.sideBlocks).find((e=>"myoverview"==e.name)),this.hasSideBlocks=n&&u.a.hasSupportedBlock(e.sideBlocks),yield h.a.nextTicks(2),this.myOverviewBlock=null===(s=null===(t=this.block)||void 0===t?void 0:t.dynamicComponent)||void 0===s?void 0:s.instance,this.loadedBlock||n||this.loadFallbackBlock()}catch(e){C.a.showErrorModal(e),this.loadFallbackBlock()}else r?this.loadedBlock=void 0:this.loadFallbackBlock();this.loaded=!0,this.onReadyPromise.resolve()}))}loadSiteName(){return Object(n.a)(this,void 0,void 0,(function*(){const e=y.b.getRequiredCurrentSite();this.siteName=(yield e.getSiteName())||""}))}loadFallbackBlock(){this.loadedBlock={name:"myoverview",visible:!0}}refresh(e){return Object(n.a)(this,void 0,void 0,(function*(){const o=[];o.push(b.a.invalidateDashboardBlocks(b.b.MY_PAGE_COURSES)),this.myOverviewBlock&&o.push(h.a.ignoreErrors(this.myOverviewBlock.invalidateContent())),Promise.all(o).finally((()=>{this.loadContent().finally((()=>{null==e?void 0:e.complete()}))}))}))}ngOnDestroy(){var e;null===(e=this.updateSiteObserver)||void 0===e?void 0:e.off(),this.loadsManagerSubscription.unsubscribe()}ready(){return Object(n.a)(this,void 0,void 0,(function*(){return yield this.onReadyPromise}))}}return CoreCoursesMyPage.ɵfac=function CoreCoursesMyPage_Factory(e){return new(e||CoreCoursesMyPage)(m.yc(c.a))},CoreCoursesMyPage.ɵcmp=m.sc({type:CoreCoursesMyPage,selectors:[["page-core-courses-my"]],viewQuery:function CoreCoursesMyPage_Query(e,o){var t;(1&e&&m.ud(d.a,!0),2&e)&&(m.dd(t=m.Nc())&&(o.block=t.first))},features:[m.kc([{provide:c.a,useClass:c.a}])],decls:25,vars:15,consts:[["slot","start"],[3,"text"],["src","assets/img/top_logo.png",1,"core-header-logo",3,"alt"],["slot","end"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],[1,"ion-text-wrap","divider"],["id","core-courses-my-title",1,"big"],["slot","end",1,"flex-row"],["class","core-button-spinner",4,"ngIf"],["contextLevel","user","labelledBy","core-courses-my-title",3,"block","instanceId",4,"ngIf"],["slot","fixed","contextLevel","user",3,"instanceId","myDashboardPage",4,"ngIf"],["icon","fas-cubes",3,"message",4,"ngIf"],[1,"core-button-spinner"],["fill","clear",3,"click",4,"ngIf"],["class","core-course-download-courses-progress","role","progressbar",4,"ngIf"],[4,"ngIf"],["fill","clear",3,"click"],["slot","icon-only","aria-hidden","true",3,"name"],["role","progressbar",1,"core-course-download-courses-progress"],["contextLevel","user","labelledBy","core-courses-my-title",3,"block","instanceId"],["slot","fixed","contextLevel","user",3,"instanceId","myDashboardPage"],["icon","fas-cubes",3,"message"]],template:function CoreCoursesMyPage_Template(e,o){1&e&&(m.Ec(0,"ion-header"),m.Ec(1,"ion-toolbar"),m.Ec(2,"ion-buttons",0),m.zc(3,"ion-back-button",1),m.Pc(4,"translate"),m.Dc(),m.Ec(5,"ion-title"),m.zc(6,"img",2),m.Dc(),m.Ec(7,"ion-buttons",3),m.zc(8,"core-user-menu-button"),m.Dc(),m.Dc(),m.Dc(),m.Ec(9,"ion-content"),m.Ec(10,"ion-refresher",4),m.Mc("ionRefresh",(function CoreCoursesMyPage_Template_ion_refresher_ionRefresh_10_listener(e){return o.refresh(e.target)})),m.zc(11,"ion-refresher-content",5),m.Pc(12,"translate"),m.Dc(),m.Ec(13,"core-loading",6),m.Ec(14,"ion-item",7),m.Ec(15,"ion-label"),m.Ec(16,"h2",8),m.pd(17),m.Pc(18,"translate"),m.Dc(),m.Dc(),m.Ec(19,"div",9),m.nd(20,CoreCoursesMyPage_div_20_Template,4,3,"div",10),m.Dc(),m.Dc(),m.Ec(21,"ion-list"),m.nd(22,CoreCoursesMyPage_core_block_22_Template,1,2,"core-block",11),m.Dc(),m.nd(23,CoreCoursesMyPage_core_block_side_blocks_button_23_Template,1,2,"core-block-side-blocks-button",12),m.nd(24,CoreCoursesMyPage_core_empty_box_24_Template,2,3,"core-empty-box",13),m.Dc(),m.Dc()),2&e&&(m.lc(3),m.Vc("text",m.Qc(4,9,"core.back")),m.lc(7),m.Vc("disabled",!o.loaded),m.lc(1),m.Wc("pullingText",m.Qc(12,11,"core.pulltorefresh")),m.lc(2),m.Vc("hideUntil",o.loaded),m.lc(4),m.qd(m.Qc(18,13,"core.courses.mycourses")),m.lc(3),m.Vc("ngIf",o.downloadCoursesEnabled&&o.myOverviewBlock&&o.myOverviewBlock.filteredCourses.length>0),m.lc(2),m.Vc("ngIf",null==o.loadedBlock?null:o.loadedBlock.visible),m.lc(1),m.Vc("ngIf",o.hasSideBlocks),m.lc(1),m.Vc("ngIf",!o.loadedBlock))},directives:[f.C,f.Ab,f.m,f.h,f.i,f.yb,p.a,k.a,f.v,f.bb,f.cb,M.a,f.I,f.O,P.t,f.P,w.a,f.l,f.D,D.a,f.k,f.qb,d.a,O.a,B.a],pipes:[E.d],styles:["[_nghost-%COMP%]     ion-item-divider{display:none!important}[_nghost-%COMP%]     core-loading{--internal-loading-inline-min-height:calc(100vh - var(--core-header-toolbar-height))}ion-tabs.placement-bottom[_nghost-%COMP%]     core-loading, ion-tabs.placement-bottom   [_nghost-%COMP%]     core-loading{--internal-loading-inline-min-height:calc(100vh - var(--core-header-toolbar-height) - var(--bottom-tabs-size) - 2px)}core-block[_ngcontent-%COMP%]     ion-card.addon-block-myoverview{--border-width:0;--background:transparent;margin:0}"]}),CoreCoursesMyPage})();const S=[{path:"",component:I}];let T=(()=>{class CoreCoursesMyLazyModule{}return CoreCoursesMyLazyModule.ɵmod=m.wc({type:CoreCoursesMyLazyModule}),CoreCoursesMyLazyModule.ɵinj=m.vc({factory:function CoreCoursesMyLazyModule_Factory(e){return new(e||CoreCoursesMyLazyModule)},imports:[[s.m.forChild(S),a.a,r.a,i.a],s.m]}),CoreCoursesMyLazyModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&m.kd(T,{declarations:[I],imports:[s.m,a.a,r.a,i.a],exports:[s.m]}))}}]);